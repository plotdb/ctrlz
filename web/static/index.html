<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldui/ldui.min.css"><style>html,
body {
  width: 100%;
  height: 100%;
  padding: 0;
  margin: 0;
}
.scroll {
  overflow-y: scroll;
}
textarea.form-control {
  font-family: monospace;
  font-size: 1.25em;
}
*[ld=json] {
  white-space: pre-wrap;
  font-family: monospace;
  font-size: 1.25em;
}
</style></head><body class="p-4"><div class="h-100 position-relative"><div class="d-flex pb-2 w-100 position-absolute justify-content-around"><div class="flex-grow-1"><div class="btn btn-outline-secondary mr-2" ld="undo">Undo</div><div class="btn btn-outline-secondary" ld="redo">Redo</div></div><div class="text-right"><a class="btn btn-outline-secondary" href="https://github.com/plotdb/ctrlz">Github Repo</a></div></div><div class="row flex-grow-1 h-100" style="padding-top:3.5em"><div class="col-md h-100"><div class="w-100 h-100 scroll p-4 border shadow-sm rounded" ld="view"></div></div><div class="col-md h-100"><div class="w-100 h-50 pb-3"><textarea class="form-control w-100 h-100 scroll border shadow-sm rounded" ld="text"># ctrlz

JSON Edit History Manager for Undo / Redo Functionality, powered by operational transform. Keep state and support undo for anything that can be expressed / stored by JSON!


# Install

include required js file:

```
    <script src="path-to-your-ctrlz.js"></script>
```


## Usage


```
    /* init directly in constructor */
    mananger = new ctrlz({obj: obj});

    /* or alternatively, reset anytime after initialized */
    manager.reset({obj: obj});

    /* when obj is updated */
    manager.update(obj);

    /* if you have ot to apply: */ 
    manager.apply({op: op});

    /* undo, return a undo-ed object */
    ret = manager.undo();

    /* redo, return a redo-ed object */
    ret = manager.redo();

    /* clean history */
    mananger.clear();
```


## License

MIT.
</textarea></div><div class="w-100 h-50 pt-3"><div class="w-100 h-100 scroll p-4 border shadow-sm rounded bg-light" ld="json"></div></div></div></div></div><script type="text/javascript" src="/assets/lib/ldui/ldui.min.js"></script><script type="text/javascript" src="/assets/lib/md2json/md2json.min.js"></script><script type="text/javascript" src="/assets/lib/marked/marked.min.js"></script><script type="text/javascript" src="/assets/lib/ctrlz/ctrlz.bundle.js"></script><script>// Generated by LiveScript 1.3.1
var lc, md, hist, view, json, e;
lc = {
  json: {},
  text: ""
};
md = require("md-2-json");
hist = new ctrlz();
view = new ldView({
  root: document.body,
  handler: {
    view: function(arg$){
      var node;
      node = arg$.node;
      return node.innerHTML = marked(lc.text);
    },
    json: function(arg$){
      var node;
      node = arg$.node;
      return node.innerText = JSON.stringify(lc.json, null, 4);
    }
  },
  action: {
    click: {
      undo: function(arg$){
        var node, json;
        node = arg$.node;
        lc.json = json = hist.undo();
        console.log(">", lc.json);
        lc.text = md.toMd(json);
        view.get('text').value = lc.text;
        return view.render();
      },
      redo: function(arg$){
        var node;
        node = arg$.node;
        lc.json = hist.redo();
        lc.text = md.toMd(lc.json);
        view.get('text').value = lc.text;
        return view.render();
      }
    },
    input: {
      text: function(arg$){
        var node, json, e;
        node = arg$.node;
        try {
          json = md.parse(lc.text = node.value || '');
        } catch (e$) {
          e = e$;
          return;
        }
        hist.update(lc.json = json);
        return view.render();
      }
    }
  }
});
try {
  json = md.parse(lc.text = view.get('text').value || '');
  hist.update(lc.json = json);
  view.render();
} catch (e$) {
  e = e$;
}</script></body></html>